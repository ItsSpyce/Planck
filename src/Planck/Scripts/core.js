var planck=function(){"use strict";function g(e,n,s){return new Promise(i=>{function r(t){t.data.operationId===n&&(typeof s>"u"||s(t.data.body))&&(i(t.data.body),console.debug("Received webmessage",n,t.data),window.chrome.webview.removeEventListener("message",r))}window.chrome.webview.addEventListener("message",r),window.chrome.webview.postMessage({...e,operationId:n}),console.debug("Posted webmessage",n,e)})}function v(e,n,s){let i=null;function r(t){t.data.operationId===n&&(typeof s>"u"||s(t.data.body))&&(i=t.data.body,console.debug("Received webmessage",n,t.data),window.chrome.webview.removeEventListener("message",r))}return window.chrome.webview.addEventListener("message",r),window.chrome.webview.postMessage({...e,operationId:n}),console.debug("Posted sync webmessage",n,e),i}function E(){let e=-1;return{current:e,next(){return e===Number.MAX_SAFE_INTEGER?e=0:e++,e}}}const f=E();async function o(e,n){const s=f.next(),[i]=await g({command:e,body:n},s);return i}function O(e,n){const s=f.next(),[i]=v({command:e,body:n},s);return i}const S=1024;class l{get remainingBytes(){return this._ledger.length-this._ledger.position}constructor(n){this._isClosed=!1,this._ledger=n,this._buffer=new Uint8Array(Math.min(n.length,S))}canRead(){return this.remainingBytes>0}[Symbol.asyncIterator](){}async readToEnd(){if(this._isClosed)throw"Cannot read from a closed stream";if(!this.canRead())return this._buffer;const n=await o("READ_STREAM",{id:this._ledger.id});return this._buffer=w(n),this._ledger.position+=this._buffer.length,this._buffer}async readNext(){if(this._isClosed)throw"Cannot read from a closed stream";if(!this.canRead())return null;const n=await o("READ_STREAM_CHUNK",{id:this._ledger.id});return this._buffer=w(n),this._ledger.position+=this._buffer.length,this._buffer}data(){return this._buffer}text(){return new TextDecoder().decode(this._buffer)}async close(){await o("CLOSE_STREAM",{id:this._ledger.id}),this._isClosed=!0}}function w(e){return Uint8Array.from(atob(e),n=>n.charCodeAt(0))}const b=Object.create(null);async function W(e){if(e in b)return b[e];const n=await o("LOAD_MODULE",{id:e});return await T(e,n)}const D="fn:";var c;(function(e){e.string="string",e.boolean="boolean",e.number="number",e.object="object",e.stream="stream",e.array="array",e.void="void",e.fn_string="fn:string",e.fn_boolean="fn:boolean",e.fn_number="fn:number",e.fn_object="fn:object",e.fn_stream="fn:stream",e.fn_array="fn:array",e.fn_void="fn:void"})(c||(c={}));async function T(e,n){const s=Object.create(null),i=n.reduce((r,t)=>({...r,[t.name]:t}),Object.create(null));return new Proxy(s,{get(r,t,d){if(typeof r[t]<"u")return r[t];if(typeof t=="symbol")return Reflect.get(r,t,d);const a=i[t];if(!(typeof a>"u")&&a.hasGetter){if(a.returnType.startsWith(D))return async function(...u){const y=await o("INVOKE_MODULE_METHOD",{id:e,method:t,args:u});switch(a.returnType){case c.fn_stream:return new l(y);default:return y}};{const u=O("GET_MODULE_PROP",{prop:t,id:e,args:{}});switch(a.returnType){case c.stream:return new l(u);default:return u}}}},set(r,t,d,a){if(typeof t=="string"&&typeof i[t]<"u")throw"Cannot set the value on a remote module property";return r[t]=d},deleteProperty(r,t){return typeof t=="string"&&typeof i[t]<"u"&&i[t].returnType===c.stream?(r[t].close(),delete r[t]):!1},has(r,t){return Object.hasOwn(r,t)}})}function _(e){return document.title=e,o("SET_WINDOW_TITLE",{title:e})}function A(e,n){return o("SET_WINDOW_SIZE",{width:e,height:n})}function I(){return o("SET_WINDOW_STATE","normal")}function L(){return o("SET_WINDOW_STATE","minimized")}function R(e){return o("SET_WINDOW_STATE",e)}var j=Object.freeze({__proto__:null,hideWindow:L,setTitle:_,setWindowSize:A,setWindowState:R,showWindow:I});function C(){window.addEventListener("contextmenu",e=>e.preventDefault()),document.addEventListener("DOMContentLoaded",()=>{m();const e=document.querySelector("title");new MutationObserver(s=>{s.forEach(m)}).observe(e,{childList:!0})})}function m(){_(document.title)}C();const h=Object.create(j);return Object.defineProperties(h,{sendMessage:{value:o,enumerable:!1,writable:!1},import:{enumerable:!1,writable:!1,value:W}}),h}();
